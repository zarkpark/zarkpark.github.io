<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KOMOJU ê²°ì œ</title>
    <script type="module" src="https://multipay.komoju.com/fields.js"></script>
    <style>
        :root,:host {
            --primary-color: #000000;
            --error-color: #df1b41;
            --secondary-color: #6d6e78;
            --placeholder-color: #6d6e78;
            --border-color: #e6e6e6;
            --selected-color: #0570de;
            --field-background: #ffffff;
            --hover-background: #cccccc1f;
        }

        .payment-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 30px;
            text-align: center;
        }

        .theme-controls {
            margin-bottom: 30px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 8px;
        }

        .color-control {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .color-control label {
            width: 200px;
            margin-right: 10px;
        }

        .color-control input[type="color"] {
            width: 50px;
            height: 30px;
            margin-right: 10px;
        }

        .color-control span {
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="payment-container">
        <h1>ê²°ì œ í˜ì´ì§€</h1>
        
        <div id="session-input-container">
            <div style="margin-bottom: 20px;">
                <label for="session-input">ì„¸ì…˜ ID:</label>
                <input type="text" id="session-input" placeholder="ì„¸ì…˜ IDë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                <button id="start-payment">ê²°ì œ ì‹œì‘</button>
            </div>

            <div style="background: #f5f5f5; padding: 15px; border-radius: 5px;">
                <p style="margin-bottom: 10px;">ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í„°ë¯¸ë„ì— ì‹¤í–‰í•œ í›„, id ê°’ì„ ì…ë ¥í•˜ì„¸ìš”</p>
                <pre style="background: #2d2d2d; color: #ffffff; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>curl -X POST https://komoju.com/api/v1/sessions \
  --user 'ë¹„ë°€í‚¤(ìí¬í•œí…Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”):' \
  --data mode=customer \
  --data amount=1000 \
  --data currency=JPY \
  --data return_url=https://example.com</code></pre>
            </div>
        </div>

        <div id="payment-section" style="display: none;">
            <div class="theme-controls">
                <h3>í…Œë§ˆ ìƒ‰ìƒ ì„¤ì •</h3>
                <div class="color-control">
                    <label>ê¸°ë³¸ ìƒ‰ìƒ:</label>
                    <input type="color" id="primary-color" value="#000000">
                    <span>#000000</span>
                </div>
                <div class="color-control">
                    <label>ì—ëŸ¬ ìƒ‰ìƒ:</label>
                    <input type="color" id="error-color" value="#df1b41">
                    <span>#df1b41</span>
                </div>
                <div class="color-control">
                    <label>ë³´ì¡° ìƒ‰ìƒ:</label>
                    <input type="color" id="secondary-color" value="#6d6e78">
                    <span>#6d6e78</span>
                </div>
                <div class="color-control">
                    <label>í”Œë ˆì´ìŠ¤í™€ë” ìƒ‰ìƒ:</label>
                    <input type="color" id="placeholder-color" value="#6d6e78">
                    <span>#6d6e78</span>
                </div>
                <div class="color-control">
                    <label>í…Œë‘ë¦¬ ìƒ‰ìƒ:</label>
                    <input type="color" id="border-color" value="#e6e6e6">
                    <span>#e6e6e6</span>
                </div>
                <div class="color-control">
                    <label>ì„ íƒ ìƒ‰ìƒ:</label>
                    <input type="color" id="selected-color" value="#0570de">
                    <span>#0570de</span>
                </div>
                <div class="color-control">
                    <label>í•„ë“œ ë°°ê²½ìƒ‰:</label>
                    <input type="color" id="field-background" value="#ffffff">
                    <span>#ffffff</span>
                </div>
            </div>

            <div style="background: #f5f5f5; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                <p style="margin-bottom: 10px;">í…ŒìŠ¤íŠ¸ ê²°ì œë¥¼ ìœ„í•´ ë‹¤ìŒ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”:</p>
                <ul style="list-style: none; padding-left: 0;">
                    <li>ğŸ‘¤ ì´ë¦„: ì•„ë¬´ ì´ë¦„ì´ë‚˜ ë„£ìœ¼ì„¸ìš” (ì˜ˆ: hj)</li>
                    <li>ğŸ’³ ì¹´ë“œë²ˆí˜¸: 4100000000000100</li>
                    <li>ğŸ“… ìœ íš¨ê¸°ê°„: 08/25</li>
                    <li>ğŸ”’ CVC: 123</li>
                </ul>
            </div>

            <form id="payment-form">
                <div id="fields-container"></div>
                <button type="submit" id="submit-button" style="margin-top: 20px;">ê²°ì œí•˜ê¸°</button>
            </form>
        </div>
    </div>

    <script>
        const sessionInput = document.getElementById('session-input');
        const startPaymentBtn = document.getElementById('start-payment');
        const paymentSection = document.getElementById('payment-section');
        const fieldsContainer = document.getElementById('fields-container');
        
        startPaymentBtn.addEventListener('click', () => {
            const sessionId = sessionInput.value.trim();
            
            if (!sessionId) {
                alert('ì„¸ì…˜ IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const komojuFields = document.createElement('komoju-fields');
            komojuFields.setAttribute('id', 'komoju-fields');
            komojuFields.setAttribute('session-id', sessionId);
            komojuFields.setAttribute('publishable-key', 'pk_test_c2w0tmxuswzsl030rzvhs0iu');
            
            fieldsContainer.innerHTML = '';
            fieldsContainer.appendChild(komojuFields);

            paymentSection.style.display = 'block';
            document.getElementById('session-input-container').style.display = 'none';

            const form = document.getElementById('payment-form');
            const submitButton = document.getElementById('submit-button');

            komojuFields.addEventListener('validityChange', (event) => {
                submitButton.disabled = !event.detail.valid;
            });

            form.addEventListener('submit', async (event) => {
                event.preventDefault();

                try {
                    const response = await fetch('/your-api-endpoint', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            sessionId: sessionId,
                            // í•„ìš”í•œ ë°ì´í„°ë“¤...
                        })
                    });

                    if (!response.ok) {
                        throw new Error('API í˜¸ì¶œ ì‹¤íŒ¨');
                    }

                    const result = await komojuFields.submit();
                    
                    form.submit();
                    
                } catch (error) {
                    console.error('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error);
                    // ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€
                }
            });

            updateTheme();
        });

        function updateTheme() {
            const colors = {
                'primary-color': '',
                'error-color': '',
                'secondary-color': '',
                'placeholder-color': '',
                'border-color': '',
                'selected-color': '',
                'field-background': '',
                'hover-background': '#cccccc1f'
            };

            Object.keys(colors).forEach(key => {
                if (key !== 'hover-background') {
                    const input = document.getElementById(key);
                    colors[key] = input.value;
                    input.nextElementSibling.textContent = input.value;
                }
            });

            const themeCSS = `:root,:host{
                --primary-color:${colors['primary-color']};
                --error-color:${colors['error-color']};
                --secondary-color:${colors['secondary-color']};
                --placeholder-color:${colors['placeholder-color']};
                --border-color:${colors['border-color']};
                --selected-color:${colors['selected-color']};
                --field-background:${colors['field-background']};
                --hover-background:${colors['hover-background']};
            }`;

            const komojuFields = document.getElementById('komoju-fields');
            komojuFields.setAttribute('theme', `data:text/css,${encodeURIComponent(themeCSS)}`);
        }

        document.querySelectorAll('input[type="color"]').forEach(input => {
            input.addEventListener('change', updateTheme);
        });
    </script>
</body>
</html> 
